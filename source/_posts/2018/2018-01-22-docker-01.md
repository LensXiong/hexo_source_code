---
layout: post
title: 【Docker 01】Docker安装(CentOS 7.4)
date: 2018-01-22 19:02:24.000000000 +09:00
categories:
- 技术
tags:
- Docker
toc: true
---

** 
摘要：`Docker` 是一个开源的应用容器引擎，基于`Go`语言并遵从`Apache2.0` 协议开源 。`Docker `可以让开发者打包他们的应用以及依赖包到一个轻量级、可移植的容器中，然后发布到任何流行的`Linux`机器上，也可以实现虚拟化。本文安装的`Docker`环境基于`CentOS 7.4`版本。
**
<!-- more -->
<The rest of contents | 余下全文>

# 前提条件
`Docker` 支持以下的`CentOS`版本：

* `CentOS 7 (64-bit)`
* `CentOS 6.5 (64-bit)` 或更高的版本

目前，`CentOS` 仅发行版本中的内核支持`Docker`。
`Docker` 运行在 `CentOS 7` 上，要求系统为64位、系统内核版本为 `3.10`以上。
`Docker` 运行在 `CentOS-6.5` 或更高的版本的`CentOS`上，要求系统为64位、系统内核版本为 `2.6.32-431` 或者更高版本。

## 查看系统版本
```
[root@wx ~]# cat /etc/redhat-release
CentOS Linux release 7.4.1708 (Core)
[root@wx ~]# lsb_release -a
LSB Version:	:core-4.1-amd64:core-4.1-noarch
Distributor ID:	CentOS
Description:	CentOS Linux release 7.4.1708 (Core)
Release:	7.4.1708
Codename:	Core
[root@wx ~]# cat /etc/issue
\S
Kernel \r on an \m
```
## 查看内核版本
```
[root@wx ~]# uname -r
3.10.0-693.2.2.el7.x86_64
[root@wx ~]# cat /proc/version
Linux version 3.10.0-693.2.2.el7.x86_64 (builder@kbuilder.dev.centos.org) (gcc version 4.8.5 20150623 (Red Hat 4.8.5-16) (GCC) ) #1 SMP Tue Sep 12 22:26:13 UTC 2017
```
# 安装和配置


## 使用 yum 安装


`Docker`软件包和依赖包已经包含在默认的 `CentOS-Extras` 软件源里，安装命令如下：
```
[root@wx ~]# yum -y install docker
```
## 使用脚本安装
① 使用`sudo`或`root`权限登录`CentOS`。
② 确保`yum`包更新到最新。
```
[root@wx ~]# sudo yum update
```
③ 执行`Docker`安装脚本。
```
[root@wx ~]# curl -fsSL https://get.docker.com/ | sh
```
④ 启动`Docker`进程。
```
[root@wx ~]# sudo service docker start
```
## 启动后台服务
`service` 命令的用法：
```
[root@wx ~]# service docker start
Redirecting to /bin/systemctl start docker.service
```
`systemctl` 命令的用法：
```
[root@wx ~]# systemctl start docker
Redirecting to /bin/systemctl start docker.service
```
## 查看版本信息
```
[root@wx ~]# docker version
Client:
 Version: 18.06.0-ce
 API version: 1.38
 Go version: go1.10.3
 Git commit: 0ffa825
 OS/Arch: linux/amd64
 Experimental: false

Server:
 Engine:
  Version: 18.06.0-ce
  API version: 1.38 (minimum version 1.12)
  Go version: go1.10.3
  Git commit: 0ffa825
  OS/Arch: linux/amd64
  Experimental: false
```
## 查看系统信息
```
[root@wx ~]# docker info
Containers: 0
Server Version: 18.06.0-ce
Storage Driver: overlay2
Backing Filesystem: extfs
Supports d_type: true
```
## 配置国内镜像
`Docker`可以配置的国内镜像有很多可供选择，比如说：阿里云，网易蜂巢，`DaoCloud`，`Docker`中国区官方镜像等。
下面以配置`Docker`中国区官方镜像为例：

使用 `vim` 修改或创建`/etc/docker/daemon.json`文件并添加上`”registry-mirrors”: [“https://registry.docker-cn.com“]`，如下：

```
# vim /etc/docker/daemon.json 
{
"registry-mirrors": ["https://registry.docker-cn.com"]
}
```
配置完之后执行下面两条命令，以使 Docker 的配置文件生效：
```
[root@wx ~]# systemctl daemon-reload
[root@wx ~]# service docker start
```

# 简单使用
## 运行镜像
验证`Docker`是否安装成功并在容器中执行一个测试的镜像。

```
[root@wx ~]# docker container run hello-world
Hello from Docker!
This message shows that your installation appears to be working correctly.
```

> 由于本地没有 `hello-world` 这个镜像，所以会下载一个 `hello-world` 的镜像，并在容器内运行。


## 列出镜像

```
[root@wx ~]# docker images
REPOSITORY TAG IMAGE ID CREATED SIZE
hello-world latest 2cb0d9787c4d 3 weeks ago 1.85kB

```